<div class="reclamation-wrapper container py-4">
  <h2 class="mb-4 text-primary">üìã Liste des R√©clamations</h2>

  <!-- üîç Search Bar -->
  <div class="input-group mb-3">
    <input
      type="text"
      class="form-control"
      placeholder="üîç Rechercher une r√©clamation..."
      [(ngModel)]="searchTerm"
    />
    <button class="btn btn-outline-secondary" type="button" (click)="searchTerm = ''">‚ùå</button>
  </div>

  <!-- ‚ö† Escalation Button -->
  <div class="mb-3">
    <button class="btn btn-outline-warning" (click)="triggerEscalation()">
      ‚ö†Ô∏è Escalader les r√©clamations en attente depuis 3 jours
    </button>
  </div>

  <!-- üìã Table -->
  <div class="table-responsive">
    <table class="table table-striped table-bordered shadow-sm rounded">
      <thead class="table-light">
        <tr>
          <th>Description</th>
          <th>Cat√©gorie</th>
          <th>Confiance IA</th>
          <th>Statut</th>
          <th>√âmotion d√©tect√©e</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let rec of filteredReclamations()">
          <td>{{ rec.description }}</td>
          <td>{{ rec.category || 'Non cat√©goris√©' }}</td>
          <td>{{ rec.aiConfidence || 0 | number: '1.2-2' }}</td>
          <td>
            <span class="badge"
                  [ngClass]="{
                    'bg-warning text-dark': rec.status === 'PENDING',
                    'bg-info text-dark': rec.status === 'IN_PROGRESS',
                    'bg-success': rec.status === 'RESOLVED',
                    'bg-secondary': rec.status === 'ESCALATED',
                    'bg-danger': rec.status === 'CANCELED'
                  }">
              {{ rec.status }}
            </span>
          </td>
          <td>{{ rec.emotion || '‚Äî' }}</td>
          <td>
            <div class="d-flex flex-column gap-2">
              <button class="btn btn-danger btn-sm mb-1" (click)="deleteReclamation(rec.id!)">
                üóë Supprimer
              </button>
              <app-response-form [reclamationId]="rec.id!"></app-response-form>
              <button class="btn btn-success btn-sm"
                      (click)="markResolved(rec.id!)"
                      [disabled]="rec.status === 'RESOLVED'">
                ‚úî Marquer comme r√©solue
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
